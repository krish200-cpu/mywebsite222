<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Complete Arrangement | Funeral Match</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@500;600&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        :root { 
            --deep-slate: #121416; --card-bg: #1C1F22; --gold: #B39359; 
            --white: #F4F4F4; --text-dim: #8A8F98; --border: rgba(255, 255, 255, 0.08);
        }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', sans-serif; }
        body { background-color: var(--deep-slate); color: var(--white); -webkit-font-smoothing: antialiased; }

        /* Header & Progress */
        .header { padding: 25px; text-align: center; border-bottom: 1px solid var(--border); position: sticky; top: 0; background: var(--deep-slate); z-index: 100; }
        .progress-track { width: 100%; max-width: 500px; height: 4px; background: var(--border); margin: 15px auto; border-radius: 10px; overflow: hidden; }
        .progress-fill { width: 10%; height: 100%; background: var(--gold); transition: 0.5s ease; }
        .step-indicator { font-size: 0.6rem; text-transform: uppercase; letter-spacing: 2px; color: var(--gold); }

        .container { max-width: 700px; margin: 0 auto; padding: 40px 20px 180px; min-height: 70vh; }
        .step-box { animation: fadeIn 0.4s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        h1 { font-family: 'Playfair Display', serif; font-size: 2rem; margin-bottom: 10px; text-align: center; }
        .desc { color: var(--text-dim); text-align: center; margin-bottom: 35px; font-size: 0.9rem; }

        /* Option Cards */
        .option-grid { display: grid; grid-template-columns: 1fr; gap: 15px; }
        .card { 
            background: var(--card-bg); border: 1px solid var(--border); padding: 25px; 
            border-radius: 20px; cursor: pointer; transition: 0.3s; display: flex; align-items: center; gap: 20px;
        }
        .card:hover { border-color: rgba(179, 147, 89, 0.4); }
        .card.active { border-color: var(--gold); background: rgba(179, 147, 89, 0.05); }
        .price { margin-left: auto; color: var(--gold); font-weight: 600; }

        /* Summary Footer */
        .footer { 
            position: fixed; bottom: 0; width: 100%; background: rgba(18, 20, 22, 0.98); 
            backdrop-filter: blur(15px); padding: 25px; border-top: 1px solid var(--border);
            display: flex; justify-content: space-between; align-items: center; z-index: 1000;
        }
        .total-box { line-height: 1.2; }
        .total-val { font-family: 'Playfair Display', serif; font-size: 1.8rem; color: var(--gold); }
        .btn-next { background: var(--gold); color: #000; padding: 18px 40px; border-radius: 14px; border: none; font-weight: 700; cursor: pointer; }

        .hidden { display: none; }
    </style>
</head>
<body>

<div class="header">
    <div class="step-indicator" id="stepTag">Step 1 of 10</div>
    <div class="progress-track"><div class="progress-fill" id="progressFill"></div></div>
</div>

<div class="container" id="mainStage">
    </div>

<div class="footer">
    <div class="total-box">
        <span style="font-size: 0.6rem; text-transform: uppercase; color: var(--text-dim);">Est. Total</span>
        <div class="total-val" id="displayTotal">£0</div>
    </div>
    <button class="btn-next" onclick="nextStep()">Continue</button>
</div>

<script>
    const urlParams = new URLSearchParams(window.location.search);
    let basePrice = parseInt(urlParams.get('base')) || 2500;
    let currentStep = 1;
    let runningTotal = basePrice;
    
    const arrangement = {
        1: { title: "Method", desc: "Burial or Cremation?", options: [
            { name: "Cremation", price: 0 }, { name: "Burial", price: 1200 }
        ]},
        2: { title: "Attendance", desc: "Type of service?", options: [
            { name: "Direct (Unattended)", price: 0 }, { name: "Attended Service", price: 600 }
        ]},
        3: { title: "Coffins & Caskets", desc: "Select a vessel.", options: [
            { name: "Basic Veneer", price: 0 }, { name: "Eco-Wicker", price: 450 }, { name: "Solid Oak", price: 950 }
        ]},
        4: { title: "Vehicles", desc: "Transport options.", options: [
            { name: "Standard Hearse", price: 0 }, { name: "Hearse + 1 Limousine", price: 400 }, { name: "Horse Drawn", price: 1000 }
        ]},
        5: { title: "Care of Deceased", desc: "Professional preparation.", options: [
            { name: "Basic Care", price: 0 }, { name: "Embalming & Dressing", price: 250 }
        ]},
        6: { title: "The Venue", desc: "Where will it be held?", options: [
            { name: "Crematorium Chapel", price: 0 }, { name: "Church Service Before", price: 350 }, { name: "Home Visit/Service", price: 200 }
        ]},
        7: { title: "Orders of Service", desc: "Stationery quantity.", options: [
            { name: "None", price: 0 }, { name: "50 Copies (Classic)", price: 150 }, { name: "100 Copies (Premium)", price: 280 }
        ]},
        8: { title: "Floral Tributes", desc: "Flowers and wreaths.", options: [
            { name: "Decide Later", price: 0 }, { name: "Casket Spray (Medium)", price: 180 }, { name: "Full Tribute", price: 350 }
        ]},
        9: { title: "Admin & Notices", desc: "Legal and media fees.", options: [
            { name: "Standard Processing", price: 150 }, { name: "Standard + Newspaper Notice", price: 300 }
        ]},
        10: { title: "Memorialization", desc: "After the service.", options: [
            { name: "Standard Urn (Included)", price: 0 }, { name: "Decorative Keepsake Urn", price: 120 }, { name: "Jewellery Options", price: 250 }
        ]}
    };

    let stepChoices = {};

    function renderStep() {
        const stage = document.getElementById('mainStage');
        const data = arrangement[currentStep];
        
        document.getElementById('stepTag').innerText = `Step ${currentStep} of 10`;
        document.getElementById('progressFill').style.width = `${currentStep * 10}%`;

        let optionsHtml = data.options.map((opt, i) => `
            <div class="card ${stepChoices[currentStep]?.name === opt.name ? 'active' : ''}" onclick="selectOpt(${i})">
                <div class="details">
                    <h3>${opt.name}</h3>
                </div>
                <div class="price">${opt.price > 0 ? '+£' + opt.price : 'Included'}</div>
            </div>
        `).join('');

        stage.innerHTML = `
            <div class="step-box">
                <h1>${data.title}</h1>
                <p class="desc">${data.desc}</p>
                <div class="option-grid">${optionsHtml}</div>
            </div>
        `;
    }

    function selectOpt(index) {
        const data = arrangement[currentStep];
        stepChoices[currentStep] = data.options[index];
        calculateTotal();
        renderStep();
    }

    function calculateTotal() {
        let addonSum = 0;
        Object.values(stepChoices).forEach(choice => addonSum += choice.price);
        runningTotal = basePrice + addonSum;
        document.getElementById('displayTotal').innerText = `£${runningTotal.toLocaleString()}`;
    }

    function nextStep() {
        if (!stepChoices[currentStep]) {
            alert("Please select an option to continue.");
            return;
        }
        if (currentStep < 10) {
            currentStep++;
            renderStep();
            window.scrollTo(0,0);
        } else {
            window.location.href = 'success.html';
        }
    }

    renderStep();
    calculateTotal();
</script>
</body>
</html>
