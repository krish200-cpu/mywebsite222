<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Personalised Quote Engine | Funeral Match</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        :root { 
            --midnight: #0D0E0F; --stone: #16181A; --gold: #B39359; 
            --white: #FFFFFF; --text-dim: #7A7E85; --border: rgba(255,255,255,0.05);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', sans-serif; }
        body { background-color: var(--midnight); color: var(--white); -webkit-font-smoothing: antialiased; }

        /* Fixed Automation Header */
        .quote-monitor {
            position: sticky; top: 0; z-index: 100;
            background: rgba(13, 14, 15, 0.95); backdrop-filter: blur(15px);
            border-bottom: 1px solid var(--border);
            padding: 20px 24px; display: flex; justify-content: space-between; align-items: center;
        }
        .current-req { font-size: 0.65rem; letter-spacing: 2px; text-transform: uppercase; color: var(--gold); }
        .current-val { font-size: 0.8rem; font-weight: 600; color: var(--white); }

        /* Soft Luxury Controls */
        .engine-controls { padding: 30px 24px 10px; display: flex; justify-content: space-between; align-items: center; }
        .sort-pill { 
            background: var(--stone); border: 1px solid var(--border); display: flex; border-radius: 4px; overflow: hidden;
        }
        .sort-opt { 
            padding: 10px 15px; font-size: 0.65rem; text-transform: uppercase; letter-spacing: 1px; 
            cursor: pointer; transition: 0.3s; color: var(--text-dim);
        }
        .sort-opt.active { background: var(--gold); color: #000; font-weight: 700; }

        .container { max-width: 700px; margin: 0 auto; padding: 20px; }

        /* Results Card */
        .entry {
            background: var(--stone); margin-bottom: 20px; padding: 30px;
            border: 1px solid var(--border); position: relative;
        }
        .entry.recommended { border: 1px solid rgba(179, 147, 89, 0.4); }
        .rec-tag { 
            position: absolute; top: -1px; right: 30px; background: var(--gold); color: #000; 
            font-size: 0.6rem; font-weight: 800; padding: 4px 12px; text-transform: uppercase; letter-spacing: 1px;
        }

        .header-row { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 20px; }
        .d-name { font-family: 'Playfair Display', serif; font-size: 1.4rem; font-weight: 400; }
        .score-wrap { text-align: right; }
        .score-val { font-size: 1.1rem; color: var(--gold); display: block; }
        .score-lbl { font-size: 0.5rem; letter-spacing: 2px; color: var(--text-dim); text-transform: uppercase; }

        .service-summary { font-size: 0.85rem; color: var(--text-dim); line-height: 1.6; margin-bottom: 25px; font-weight: 300; }

        .footer-row { 
            display: flex; justify-content: space-between; align-items: center; 
            padding-top: 25px; border-top: 1px solid var(--border);
        }
        .price-big { font-family: 'Playfair Display', serif; font-size: 1.5rem; }
        .price-big span { color: var(--gold); font-size: 0.9rem; }

        .btn-lock { 
            background: var(--gold); color: #000; padding: 12px 24px; border: none; 
            font-size: 0.7rem; font-weight: 700; text-transform: uppercase; letter-spacing: 1px; cursor: pointer;
        }

        /* Filter Modal Styles */
        .modal { 
            position: fixed; inset: 0; background: var(--midnight); z-index: 200; 
            display: none; padding: 60px 24px; flex-direction: column; 
        }
        .modal.active { display: flex; }
        .filter-title { font-size: 0.7rem; color: var(--gold); letter-spacing: 3px; text-transform: uppercase; margin-bottom: 20px; text-align: center; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 30px; }
        .pill { background: var(--stone); padding: 15px; text-align: center; border: 1px solid var(--border); font-size: 0.8rem; cursor: pointer; }
        .pill.active { border-color: var(--gold); color: var(--gold); background: rgba(179, 147, 89, 0.05); }

        footer { padding: 60px 24px; border-top: 1px solid var(--border); text-align: center; background: var(--stone); }
        .footer-nav a { font-size: 0.7rem; color: var(--text-dim); text-decoration: none; text-transform: uppercase; margin: 0 10px; letter-spacing: 1px; }
    </style>
</head>
<body>

    <div class="quote-monitor">
        <div>
            <p class="current-req">Current Configuration</p>
            <p class="current-val" id="displayConfig">Standard Attended • Secular</p>
        </div>
        <button class="btn-lock" style="padding: 10px 15px; font-size: 0.6rem;" onclick="toggleModal()">Edit</button>
    </div>

    <div class="engine-controls">
        <p style="font-size: 0.7rem; color: var(--text-dim);">25 Nearest Directors</p>
        <div class="sort-pill">
            <div class="sort-opt active" onclick="setSort('rec', this)">Recommended</div>
            <div class="sort-opt" onclick="setSort('price', this)">Cheapest</div>
        </div>
    </div>

    <div class="container" id="resultsContainer">
        </div>

    <div class="modal" id="filterModal">
        <span class="filter-title">Customise Requirements</span>
        <div class="grid">
            <div class="pill active" onclick="updateConfig('type', 'Standard', this)">Standard</div>
            <div class="pill" onclick="updateConfig('type', 'Sea', this)">Burial at Sea</div>
            <div class="pill" onclick="updateConfig('type', 'Natural', this)">Natural Burial</div>
            <div class="pill" onclick="updateConfig('type', 'Unattended', this)">Unattended</div>
        </div>
        <div class="grid">
            <div class="pill active" onclick="updateConfig('faith', 'Secular', this)">Secular</div>
            <div class="pill" onclick="updateConfig('faith', 'Religious', this)">Religious</div>
        </div>
        <button class="btn-lock" style="width: 100%; padding: 20px;" onclick="toggleModal()">Apply & Re-Calculate</button>
    </div>

    <footer>
        <div class="footer-nav">
            <a href="#">About</a> <a href="#">Legal</a> <a href="#">Privacy</a>
            <a href="#" style="color: var(--gold);">Director Portal</a>
        </div>
    </footer>

    <script>
        const directors = Array.from({length: 25}, (_, i) => ({
            id: i,
            name: ["Evergreen", "Belgrave", "Oceanic", "Ethos", "Heritage"][i % 5] + " Partners " + (i + 1),
            score: 90 + Math.floor(Math.random() * 10),
            basePrice: 2000 + (Math.random() * 2000),
            specialism: i % 4 === 0 ? 'Sea' : (i % 3 === 0 ? 'Natural' : 'Standard'),
            faith: i % 5 === 0 ? 'Religious' : 'Secular'
        }));

        let config = { type: 'Standard', faith: 'Secular' };
        let currentSort = 'rec';

        function updateConfig(key, val, el) {
            config[key] = val;
            el.parentElement.querySelectorAll('.pill').forEach(p => p.classList.remove('active'));
            el.classList.add('active');
            document.getElementById('displayConfig').innerText = `${config.type} • ${config.faith}`;
            render();
        }

        function setSort(type, el) {
            currentSort = type;
            el.parentElement.querySelectorAll('.sort-opt').forEach(p => p.classList.remove('active'));
            el.classList.add('active');
            render();
        }

        function render() {
            const container = document.getElementById('resultsContainer');
            container.innerHTML = '';

            let list = directors.map(d => {
                let finalPrice = d.basePrice;
                if(config.type === 'Sea') finalPrice += 1500;
                if(config.type === 'Natural') finalPrice += 400;
                return {...d, finalPrice};
            });

            // Filtering
            list = list.filter(d => d.specialism === config.type || d.id === 0); // Always show sponsored

            // Sorting Engine
            if(currentSort === 'cheapest') {
                list.sort((a,b) => a.finalPrice - b.finalPrice);
            } else {
                list.sort((a,b) => b.score - a.score);
            }

            list.forEach((d, idx) => {
                const isRecommended = currentSort === 'rec' && idx === 0;
                container.innerHTML += `
                    <div class="entry ${isRecommended ? 'recommended' : ''}">
                        ${isRecommended ? '<div class="rec-tag">Recommended</div>' : ''}
                        <div class="header-row">
                            <h2 class="d-name">${d.name}</h2>
                            <div class="score-wrap">
                                <span class="score-val">${d.score}</span>
                                <span class="score-lbl">Score</span>
                            </div>
                        </div>
                        <p class="service-summary">Professional specialist in ${d.specialism} arrangements. Verified facilities and response standards.</p>
                        <div class="footer-row">
                            <div class="price-group">
                                <p style="font-size: 0.55rem; color: var(--text-dim); text-transform: uppercase;">Estimated Quote</p>
                                <h3 class="price-big"><span>£</span>${Math.floor(d.finalPrice).toLocaleString()}</h3>
                            </div>
                            <button class="btn-lock">Lock Price</button>
                        </div>
                    </div>
                `;
            });
        }

        function toggleModal() { document.getElementById('filterModal').classList.toggle('active'); }
        render();
    </script>
</body>
</html>
