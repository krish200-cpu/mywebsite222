<!DOCTYPE html>
<html lang="en-GB">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>FuneralMatch | Director Search</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Bodoni+Moda:ital,wght@1,400;1,700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">

    <style>
        /* --- 1. CORE VARIABLES --- */
        :root {
            --gold: #C5A059;
            --black: #111;
            --off-white: #F9F9F9;
            --radius-lg: 24px;
            --radius-pill: 999px;
            --safe-bottom: env(safe-area-inset-bottom, 20px);
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--off-white);
            color: var(--black);
            -webkit-font-smoothing: antialiased;
            /* Prevent horizontal scroll */
            overflow-x: hidden;
            padding-bottom: 80px;
        }
        .serif { font-family: 'Bodoni Moda', serif; }

        /* --- 2. HEADER & LOGO --- */
        .header-fixed {
            position: fixed; top: 0; left: 0; right: 0; z-index: 50;
            background: rgba(255,255,255,0.95); backdrop-filter: blur(10px);
            border-bottom: 1px solid #eee;
            padding: 16px 20px;
            display: flex; align-items: center; justify-content: space-between;
        }

        .brand-block { display: flex; flex-direction: column; }
        .brand-main { font-size: 14px; font-weight: 800; text-transform: uppercase; letter-spacing: 0.05em; color: black; }
        .brand-sub { font-size: 10px; font-weight: 700; color: var(--gold); letter-spacing: 0.2em; text-transform: uppercase; }

        /* --- 3. MOBILE SEARCH BAR (Sticky) --- */
        .search-sticky {
            position: sticky; top: 68px; z-index: 40;
            margin: 0 16px 24px 16px;
        }
        
        .search-capsule {
            background: white; border-radius: var(--radius-pill);
            box-shadow: 0 4px 20px rgba(0,0,0,0.06);
            border: 1px solid #eee;
            display: flex; padding: 6px;
        }

        .search-input {
            flex: 1; border: none; outline: none; padding-left: 20px;
            font-size: 16px; /* Prevents iOS Zoom */
            border-radius: var(--radius-pill);
            color: #333; background: transparent;
        }

        .filter-btn {
            background: #111; color: white;
            height: 44px; padding: 0 20px; border-radius: var(--radius-pill);
            font-size: 13px; font-weight: 600; cursor: pointer;
            display: flex; align-items: center; gap: 8px;
            transition: 0.2s;
        }
        .filter-btn:active { transform: scale(0.96); }
        .badge {
            background: var(--gold); color: white; font-size: 10px; 
            padding: 2px 6px; border-radius: 99px; margin-left: 4px; display: none;
        }

        /* --- 4. BOTTOM SHEET FILTER (Mobile Friendly) --- */
        .sheet-overlay {
            position: fixed; inset: 0; background: rgba(0,0,0,0.5); z-index: 100;
            opacity: 0; pointer-events: none; transition: 0.3s; backdrop-filter: blur(4px);
        }
        .sheet-overlay.open { opacity: 1; pointer-events: auto; }

        .sheet-content {
            position: absolute; bottom: 0; left: 0; right: 0;
            background: white; border-radius: 24px 24px 0 0;
            max-height: 85vh; overflow-y: auto;
            transform: translateY(100%); transition: transform 0.4s cubic-bezier(0.16, 1, 0.3, 1);
            padding: 24px 24px 100px 24px; /* Padding for bottom button */
        }
        .sheet-overlay.open .sheet-content { transform: translateY(0); }

        .sheet-header {
            display: flex; justify-content: space-between; align-items: center;
            padding-bottom: 20px; border-bottom: 1px solid #f0f0f0; margin-bottom: 20px;
            position: sticky; top: 0; background: white; z-index: 10;
        }

        /* Thumb-Friendly Toggles (Chips) */
        .chip-grid { display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 24px; }
        
        .filter-chip {
            padding: 10px 18px; border-radius: 12px;
            background: #f5f5f5; border: 1px solid transparent;
            font-size: 13px; font-weight: 600; color: #555;
            cursor: pointer; transition: 0.2s; user-select: none;
            display: flex; align-items: center; gap: 8px;
        }
        
        /* Selected State */
        .filter-chip.active {
            background: #FFFDF5; border-color: var(--gold); color: var(--gold);
            box-shadow: 0 4px 12px rgba(197, 160, 89, 0.15);
        }
        
        /* Price Slider */
        input[type=range] {
            width: 100%; accent-color: var(--gold); height: 4px; margin: 20px 0;
        }

        /* Floating Apply Button */
        .sheet-footer {
            position: fixed; bottom: 0; left: 0; right: 0;
            padding: 16px 24px; background: white; border-top: 1px solid #eee;
            padding-bottom: max(16px, var(--safe-bottom));
        }
        .btn-apply {
            width: 100%; background: var(--black); color: white;
            padding: 16px; border-radius: var(--radius-pill);
            font-size: 14px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.1em;
        }

        /* --- 5. DIRECTOR CARD --- */
        .card-grid {
            display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px; padding: 0 16px; max-width: 1200px; margin: 0 auto;
        }

        .director-card {
            background: white; border-radius: 20px; overflow: hidden;
            box-shadow: 0 4px 20px rgba(0,0,0,0.03); border: 1px solid #eee;
            transition: 0.3s;
        }
        .director-card:active { transform: scale(0.98); }

        .card-img { height: 180px; width: 100%; object-fit: cover; }
        
        .card-content { padding: 20px; }
        
        .tag-pill {
            font-size: 10px; font-weight: 700; text-transform: uppercase;
            padding: 4px 10px; border-radius: 6px; background: #f0f0f0; color: #666;
            margin-right: 4px; display: inline-block; margin-bottom: 8px;
        }
        .tag-pill.gold { background: #FFF9E5; color: #B08D55; }

        .price-badge {
            font-size: 16px; font-weight: 700; color: var(--gold);
        }

    </style>
</head>
<body>

    <header class="header-fixed">
        <div class="brand-block">
            <span class="brand-main">FuneralMatch</span>
            <span class="brand-sub">Director Search</span>
        </div>
        <div class="w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center text-gray-400">
            <i class="fas fa-user"></i>
        </div>
    </header>

    <div style="height: 80px;"></div>

    <div class="search-sticky">
        <div class="search-capsule">
            <input type="text" id="searchInput" class="search-input" placeholder="City or Director Name...">
            <div class="filter-btn" onclick="openFilters()">
                <i class="fas fa-sliders-h"></i> Filters <span class="badge" id="filterCount">0</span>
            </div>
        </div>
    </div>

    <main class="card-grid" id="resultsGrid">
        </main>

    <div id="filterOverlay" class="sheet-overlay" onclick="closeFilters()">
        <div class="sheet-content" onclick="event.stopPropagation()">
            
            <div class="sheet-header">
                <h2 class="text-lg font-bold font-serif">Refine Results</h2>
                <button onclick="closeFilters()" class="w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center"><i class="fas fa-times"></i></button>
            </div>

            <h3 class="text-xs font-bold text-gray-400 uppercase tracking-widest mb-3">Specialist Requirements</h3>
            <div class="chip-grid">
                <div class="filter-chip" onclick="toggleChip(this, 'tag_greek')">üá¨üá∑ Greek Orthodox</div>
                <div class="filter-chip" onclick="toggleChip(this, 'tag_water')">üåä Burial at Sea</div>
                <div class="filter-chip" onclick="toggleChip(this, 'tag_jewish')">‚ú°Ô∏è Jewish</div>
                <div class="filter-chip" onclick="toggleChip(this, 'tag_military')">üéñÔ∏è Military</div>
                <div class="filter-chip" onclick="toggleChip(this, 'tag_eco')">üåø Eco Burial</div>
            </div>

            <h3 class="text-xs font-bold text-gray-400 uppercase tracking-widest mb-3">Merit & Quality</h3>
            <div class="chip-grid">
                <div class="filter-chip" onclick="toggleChip(this, 'rating_99')">
                    <i class="fas fa-star text-yellow-400"></i> Elite (9.9+)
                </div>
                <div class="filter-chip" onclick="toggleChip(this, 'rating_95')">
                    <i class="fas fa-certificate text-gray-400"></i> High Merit (9.5+)
                </div>
            </div>

            <h3 class="text-xs font-bold text-gray-400 uppercase tracking-widest mb-2 mt-6">Max Budget</h3>
            <div class="flex justify-between items-end mb-2">
                <span class="text-sm font-bold text-black" id="priceLabel">¬£10,000</span>
            </div>
            <input type="range" min="1000" max="10000" step="100" value="10000" oninput="updatePrice(this.value)">

            <div class="sheet-footer">
                <button class="btn-apply" onclick="applyFilters()">Show Results</button>
            </div>
        </div>
    </div>

    <script>
        // === MOCK DATA ===
        const directors = [
            { 
                name: "Olympus & Sons", 
                loc: "North London", 
                price: 3200, 
                rating: 9.9, 
                tags: ["tag_greek", "tag_water"], 
                img: "https://images.unsplash.com/photo-1544197150-b99a580bb7a8" 
            },
            { 
                name: "Regency Care", 
                loc: "West London", 
                price: 3500, 
                rating: 10.0, 
                tags: ["tag_military"], 
                img: "https://images.unsplash.com/photo-1560185007-c5ca9d2c014d" 
            },
            { 
                name: "Willow Eco", 
                loc: "Hackney", 
                price: 1800, 
                rating: 9.6, 
                tags: ["tag_eco", "tag_water"], 
                img: "https://images.unsplash.com/photo-1473448912268-2022ce9509d8" 
            },
            { 
                name: "Goldstein Family", 
                loc: "Golders Green", 
                price: 2800, 
                rating: 9.9, 
                tags: ["tag_jewish"], 
                img: "https://images.unsplash.com/photo-1486406146926-c627a92ad1ab" 
            },
            // Fillers
            ...Array.from({length: 10}, (_, i) => ({
                name: `Director ${i+5}`,
                loc: "London",
                price: 1500 + (i*150),
                rating: (9.0 + Math.random()).toFixed(1),
                tags: [],
                img: "https://images.unsplash.com/photo-1519817650390-64a93db51149"
            }))
        ];

        let activeTags = [];
        let maxPrice = 10000;

        // === RENDER ===
        function render(data) {
            const grid = document.getElementById('resultsGrid');
            grid.innerHTML = '';

            if (data.length === 0) {
                grid.innerHTML = `
                    <div class="col-span-full text-center py-20 text-gray-400">
                        <i class="fas fa-search text-4xl mb-4"></i>
                        <p>No directors found matching these specific filters.</p>
                        <button onclick="resetAll()" class="mt-4 text-[#C5A059] font-bold text-sm">Clear Filters</button>
                    </div>`;
                return;
            }

            data.forEach((d, i) => {
                // Determine Labels
                let pills = '';
                if(d.tags.includes('tag_greek')) pills += `<span class="tag-pill gold">Greek</span>`;
                if(d.tags.includes('tag_water')) pills += `<span class="tag-pill gold">Water Burial</span>`;
                if(d.tags.includes('tag_jewish')) pills += `<span class="tag-pill gold">Jewish</span>`;
                
                const card = document.createElement('div');
                card.className = 'director-card';
                card.setAttribute('data-aos', 'fade-up');
                card.setAttribute('data-aos-delay', i * 50); // Stagger

                card.innerHTML = `
                    <img src="${d.img}?q=80&w=600&fit=crop" class="card-img">
                    <div class="card-content">
                        <div class="flex justify-between items-start mb-2">
                            <div>
                                ${pills}
                                <p class="text-[10px] uppercase font-bold text-gray-400">${d.loc}</p>
                            </div>
                            <div class="flex items-center gap-1 bg-gray-50 px-2 py-1 rounded text-xs font-bold">
                                <i class="fas fa-star text-yellow-400"></i> ${d.rating}
                            </div>
                        </div>
                        <h3 class="font-serif text-xl font-bold mb-4">${d.name}</h3>
                        <div class="flex justify-between items-center border-t border-gray-100 pt-4">
                            <span class="price-badge">¬£${d.price.toLocaleString()}</span>
                            <button class="w-8 h-8 rounded-full border border-gray-200 flex items-center justify-center text-gray-400">
                                <i class="fas fa-arrow-right"></i>
                            </button>
                        </div>
                    </div>
                `;
                grid.appendChild(card);
            });
        }

        // === FILTER LOGIC ===
        function toggleChip(el, tag) {
            el.classList.toggle('active');
            if (activeTags.includes(tag)) {
                activeTags = activeTags.filter(t => t !== tag);
            } else {
                activeTags.push(tag);
            }
        }

        function updatePrice(val) {
            maxPrice = parseInt(val);
            document.getElementById('priceLabel').innerText = `¬£${Number(val).toLocaleString()}`;
        }

        function applyFilters() {
            // Update Badge
            const count = activeTags.length;
            const badge = document.getElementById('filterCount');
            badge.innerText = count;
            badge.style.display = count > 0 ? 'inline-block' : 'none';

            // Filter
            const search = document.getElementById('searchInput').value.toLowerCase();
            
            const filtered = directors.filter(d => {
                // 1. Search
                if (!d.name.toLowerCase().includes(search) && !d.loc.toLowerCase().includes(search)) return false;
                
                // 2. Price
                if (d.price > maxPrice) return false;

                // 3. Tags (AND Logic)
                const reqTags = activeTags.filter(t => !t.startsWith('rating'));
                const hasTags = reqTags.every(t => d.tags.includes(t));
                if(!hasTags) return false;

                // 4. Rating
                if (activeTags.includes('rating_99') && d.rating < 9.9) return false;
                if (activeTags.includes('rating_95') && d.rating < 9.5) return false;

                return true;
            });

            render(filtered);
            closeFilters();
            window.scrollTo({top: 0, behavior: 'smooth'});
        }

        function resetAll() {
            activeTags = [];
            maxPrice = 10000;
            document.querySelectorAll('.filter-chip').forEach(c => c.classList.remove('active'));
            applyFilters();
        }

        // === UI UTILS ===
        function openFilters() {
            document.getElementById('filterOverlay').classList.add('open');
            document.body.style.overflow = 'hidden'; // Prevent background scroll
        }

        function closeFilters() {
            document.getElementById('filterOverlay').classList.remove('open');
            document.body.style.overflow = '';
        }

        // Search Listener
        document.getElementById('searchInput').addEventListener('input', applyFilters);

        // Init
        render(directors);
        AOS.init();

    </script>
</body>
</html>
