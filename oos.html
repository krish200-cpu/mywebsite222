<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Typography Studio | FuneralMatch</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Bodoni+Moda:ital,wght@0,400;0,700;1,400&family=Inter:wght@300;400;500;600&family=Cormorant+Garamond:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">

    <style>
        /* --- CORE VARIABLES --- */
        :root {
            --bg: #050505;
            --surface: #121212;
            --border: #222;
            --gold: #D4AF37;
            --gold-glow: rgba(212, 175, 55, 0.2);
            --page-ratio: 1.414;
        }

        body {
            background-color: var(--bg);
            color: white;
            font-family: 'Inter', sans-serif;
            height: 100vh;
            overflow: hidden; /* Prevent body scroll, use workspace scroll */
        }

        /* --- WORKSPACE --- */
        .workspace-container {
            height: 100%;
            overflow-y: auto;
            scroll-behavior: smooth;
            padding: 80px 20px 160px 20px; /* Top bar & Dock padding */
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 40px;
        }

        /* --- THE PAGE CARD --- */
        .page-card {
            width: 100%; max-width: 500px;
            aspect-ratio: 1 / var(--page-ratio);
            background: white; color: black;
            position: relative;
            border-radius: 4px;
            box-shadow: 0 20px 50px -10px rgba(0,0,0,0.5);
            transition: 0.3s ease;
        }
        
        .page-card.active {
            box-shadow: 0 0 0 3px var(--gold), 0 30px 80px -20px rgba(0,0,0,0.8);
            transform: scale(1.01); z-index: 10;
        }

        .page-label {
            position: absolute; top: -30px; left: 0;
            font-size: 10px; font-weight: 700; text-transform: uppercase; 
            letter-spacing: 0.1em; color: #666;
        }

        /* --- EDITABLES --- */
        [contenteditable="true"] {
            outline: none; border: 1px dashed transparent; transition: 0.2s;
            cursor: text; min-height: 1em; border-radius: 4px;
        }
        [contenteditable="true"]:hover { border-color: var(--gold-glow); background: rgba(0,0,0,0.02); }
        [contenteditable="true"]:focus { border-color: var(--gold); background: rgba(212, 175, 55, 0.05); }

        .photo-zone {
            background: #f4f4f4; width: 100%; display: flex; align-items: center; justify-content: center;
            cursor: pointer; overflow: hidden; position: relative; color: #ccc; transition: 0.2s;
        }
        .photo-zone:hover { opacity: 0.8; box-shadow: inset 0 0 0 2px var(--gold); }
        .photo-zone img { width: 100%; height: 100%; object-fit: cover; }

        /* --- HEADER & DOCK --- */
        .glass-bar {
            background: rgba(20, 20, 20, 0.95);
            backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255,255,255,0.1);
        }

        .top-bar {
            position: fixed; top: 0; left: 0; right: 0; height: 60px; z-index: 50;
            display: flex; justify-content: space-between; align-items: center; padding: 0 20px;
            border-bottom: 1px solid var(--border);
        }

        .dock {
            position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%);
            border-radius: 99px; padding: 8px 12px; z-index: 50;
            display: flex; gap: 12px; box-shadow: 0 20px 50px rgba(0,0,0,0.6);
        }

        .dock-btn {
            height: 48px; padding: 0 24px; border-radius: 99px;
            font-size: 11px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em;
            display: flex; align-items: center; gap: 8px; cursor: pointer; transition: 0.2s;
            color: #aaa; border: 1px solid transparent;
        }
        .dock-btn:hover { color: white; background: rgba(255,255,255,0.05); }
        .dock-btn.primary { background: var(--gold); color: black; }
        .dock-btn.primary:hover { background: white; }

        /* --- FONT LIBRARY DRAWER (The Concierge) --- */
        #font-drawer {
            position: fixed; bottom: 0; left: 0; right: 0; height: 80vh;
            background: #111; border-top-left-radius: 24px; border-top-right-radius: 24px;
            z-index: 100; transform: translateY(100%); transition: transform 0.4s cubic-bezier(0.16, 1, 0.3, 1);
            display: flex; flex-direction: column;
            box-shadow: 0 -20px 60px rgba(0,0,0,0.8);
            border-top: 1px solid #333;
        }
        #font-drawer.open { transform: translateY(0); }

        .drawer-header {
            padding: 20px; border-bottom: 1px solid #222;
            display: flex; flex-direction: column; gap: 16px;
        }

        .search-input {
            width: 100%; background: #000; border: 1px solid #333; color: white;
            padding: 12px 16px; border-radius: 12px; font-size: 14px; outline: none;
            transition: 0.2s;
        }
        .search-input:focus { border-color: var(--gold); }

        .font-list {
            flex: 1; overflow-y: auto; padding: 10px;
            display: grid; grid-template-columns: 1fr; gap: 4px;
        }
        
        .font-item {
            padding: 16px; border-radius: 8px; cursor: pointer;
            display: flex; justify-content: space-between; align-items: center;
            transition: 0.2s; border: 1px solid transparent;
        }
        .font-item:hover { background: #1a1a1a; }
        .font-item.selected { border-color: var(--gold); background: rgba(197, 160, 89, 0.1); }
        
        .font-name { font-size: 16px; color: white; }
        .font-preview { font-size: 12px; color: #666; margin-top: 4px; }

        /* Custom Scrollbar for Font List */
        .font-list::-webkit-scrollbar { width: 6px; }
        .font-list::-webkit-scrollbar-thumb { background: #333; border-radius: 3px; }

    </style>
</head>
<body>

    <div class="glass-bar top-bar">
        <div class="flex flex-col">
            <span class="text-[9px] uppercase font-bold text-[#D4AF37] tracking-widest">FuneralMatch</span>
            <span class="text-xs font-bold text-white">Typography Studio</span>
        </div>
        <button onclick="alert('Saved!')" class="text-xs font-bold text-[#D4AF37] hover:text-white">Save</button>
    </div>

    <div class="workspace-container" id="workspace">
        </div>

    <div class="glass-bar dock">
        <button class="dock-btn" onclick="openFontLibrary()">
            <i class="fas fa-font"></i> <span>Fonts</span>
        </button>
        <div class="w-px h-6 bg-white/10"></div>
        <button class="dock-btn primary" onclick="alert('Print')">
            <span>Print</span> <i class="fas fa-arrow-right"></i>
        </button>
    </div>

    <div id="font-drawer">
        <div class="drawer-header">
            <div class="flex justify-between items-center">
                <span class="text-xs font-bold text-gray-500 uppercase tracking-widest">Font Library</span>
                <button onclick="closeFontLibrary()" class="text-gray-400 hover:text-white"><i class="fas fa-times text-xl"></i></button>
            </div>
            <div class="relative">
                <i class="fas fa-search absolute left-4 top-3.5 text-gray-500 text-xs"></i>
                <input type="text" id="font-search" class="search-input pl-10" placeholder="Search 100+ fonts..." onkeyup="filterFonts()">
            </div>
        </div>
        <div class="font-list" id="font-list-container">
            </div>
    </div>

    <input type="file" id="img-upload" class="hidden" accept="image/*">

    <script>
        // === 1. THE 100 FONTS DATABASE ===
        const FONT_LIBRARY = [
            "Arial", "Helvetica", "Times New Roman", "Georgia", "Garamond", "Baskerville", "Palatino", "Verdana", "Tahoma", "Trebuchet MS",
            "Courier New", "Consolas", "Lucida Console", "Monaco", "Roboto", "Open Sans", "Lato", "Montserrat", "Poppins", "Inter",
            "Source Sans Pro", "Noto Sans", "Noto Serif", "PT Sans", "PT Serif", "Raleway", "Nunito", "Ubuntu", "Merriweather", "Playfair Display",
            "Oswald", "Fira Sans", "Work Sans", "Cabin", "Quicksand", "Karla", "Mulish", "DM Sans", "Manrope", "Rubik",
            "Abril Fatface", "Bebas Neue", "Anton", "League Spartan", "Archivo", "Arvo", "Bitter", "Zilla Slab", "Spectral", "Crimson Text",
            "Josefin Sans", "Dancing Script", "Pacifico", "Lobster", "Caveat", "Indie Flower", "Abril Text", "Assistant", "Heebo", "Exo",
            "Exo 2", "Titillium Web", "Oxygen", "Hind", "Mukta", "Inconsolata", "Space Mono", "JetBrains Mono", "IBM Plex Sans", "IBM Plex Serif",
            "IBM Plex Mono", "Charter", "Franklin Gothic", "Century Gothic", "Gill Sans", "Optima", "Avenir", "Futura", "Univers", "Calibri",
            "Cambria", "Candara", "Segoe UI", "SF Pro", "DIN", "Gotham", "Proxima Nova", "Myriad Pro", "Helvetica Neue", "Neue Haas Grotesk",
            "Copperplate", "Rockwell", "Didot", "Bodoni", "Trajan Pro", "Perpetua", "Book Antiqua", "Sabon", "Tisa", "Cormorant"
        ];

        // === 2. STATE ===
        const state = {
            activeElement: null, // The text element currently being edited
            selectedFont: 'Bodoni Moda'
        };

        const TEMPLATE_COVER = `
            <div class="h-full flex flex-col items-center justify-center text-center p-8">
                <div class="mb-6 text-xs uppercase tracking-widest text-gray-500" contenteditable="true" onfocus="setActive(this)">In Loving Memory of</div>
                <div class="photo-zone rounded-full w-40 h-40 mb-6 border-4 border-double border-gray-100" onclick="upload(this)">
                    <i class="fas fa-camera text-2xl opacity-20"></i>
                </div>
                <div class="text-4xl mb-2 leading-tight" style="font-family: 'Bodoni Moda'" contenteditable="true" onfocus="setActive(this)">Eleanor<br>Rigby</div>
                <div class="text-sm mb-8 text-gray-600" contenteditable="true" onfocus="setActive(this)">1950 â€” 2026</div>
                <div class="mt-auto text-[10px] uppercase font-bold text-gray-400" contenteditable="true" onfocus="setActive(this)">St Mary's Church</div>
            </div>`;

        // === 3. INIT ===
        function init() {
            renderWorkspace();
            renderFontList();
        }

        function renderWorkspace() {
            const container = document.getElementById('workspace');
            const card = document.createElement('div');
            card.className = 'page-card';
            card.innerHTML = `
                <div class="page-label">Front Cover</div>
                <div class="h-full w-full">${TEMPLATE_COVER}</div>
            `;
            container.appendChild(card);
        }

        // === 4. FONT LIBRARY LOGIC ===
        function renderFontList() {
            const list = document.getElementById('font-list-container');
            list.innerHTML = '';

            FONT_LIBRARY.forEach(font => {
                const item = document.createElement('div');
                item.className = 'font-item';
                item.onclick = () => applyFont(font);
                
                // For demo, we assume system fonts render. 
                // For Google Fonts, we would lazy-load the <link> here.
                
                item.innerHTML = `
                    <div>
                        <div class="font-name" style="font-family: '${font}', sans-serif;">${font}</div>
                        <div class="font-preview" style="font-family: '${font}', sans-serif;">The quick brown fox jumps over the lazy dog</div>
                    </div>
                    ${state.selectedFont === font ? '<i class="fas fa-check text-[#D4AF37]"></i>' : ''}
                `;
                list.appendChild(item);
            });
        }

        function openFontLibrary() {
            // If no text is selected, try to find the main header
            if(!state.activeElement) {
                // Auto-select the Name
                const nameEl = document.querySelector('.text-4xl');
                if(nameEl) setActive(nameEl);
            }
            document.getElementById('font-drawer').classList.add('open');
            document.getElementById('font-search').focus();
        }

        function closeFontLibrary() {
            document.getElementById('font-drawer').classList.remove('open');
        }

        function filterFonts() {
            const query = document.getElementById('font-search').value.toLowerCase();
            const items = document.querySelectorAll('.font-item');
            
            items.forEach(item => {
                const name = item.querySelector('.font-name').innerText.toLowerCase();
                if(name.includes(query)) {
                    item.style.display = 'flex';
                } else {
                    item.style.display = 'none';
                }
            });
        }

        // === 5. APPLYING FONTS ===
        function setActive(el) {
            // Highlight the active element visually
            if(state.activeElement) state.activeElement.style.border = '1px dashed transparent';
            state.activeElement = el;
            el.style.border = '1px dashed #D4AF37';
        }

        function applyFont(fontName) {
            if(!state.activeElement) {
                alert("Please click on a text area on the page first.");
                return;
            }

            // 1. Dynamic Load (Google Fonts API Trick)
            // We create a link tag on the fly. 
            // Note: This works for Google Fonts. System fonts (Arial) will just work.
            const link = document.createElement('link');
            link.href = `https://fonts.googleapis.com/css2?family=${fontName.replace(/ /g, '+')}&display=swap`;
            link.rel = 'stylesheet';
            document.head.appendChild(link);

            // 2. Apply to Element
            state.activeElement.style.fontFamily = `'${fontName}', sans-serif`;
            state.selectedFont = fontName;

            // 3. Feedback
            // Re-render list to show checkmark
            renderFontList();
            
            // Optional: Close drawer after selection? No, let them explore.
        }

        // === 6. PHOTO LOGIC ===
        let activePhoto = null;
        function upload(el) {
            activePhoto = el;
            document.getElementById('img-upload').click();
        }
        document.getElementById('img-upload').onchange = (e) => {
            if(e.target.files[0] && activePhoto) {
                const reader = new FileReader();
                reader.onload = (evt) => {
                    activePhoto.innerHTML = `<img src="${evt.target.result}">`;
                    activePhoto.style.background = 'transparent';
                    activePhoto.style.border = 'none';
                };
                reader.readAsDataURL(e.target.files[0]);
            }
        }

        // Boot
        init();

    </script>
</body>
</html>
